<section id="page-common">
	
	 <app-booking-header [bookingState]="selectedBookingModel.state" [isCancelOrUnable]="isCancelledOrUnableToServe" [invitePress]="invitePressed"
						[unAssignPress]="unAssignPressed" [reAssignPress]="reAssignPressed" [showButtons]='true'></app-booking-header>

	<section id="job-booking">
		<main>
			<h2>Job Details</h2>
			<table id="job-details-responsive" class="custom-small-table">
				<thead>
					<tr>
						<th width="5%">Job</th>
						<th width="14%">Date</th>
						<th width="7%">Org</th>
						<th width="6%">Client</th>
						<th width="6%">Venue</th>
						<th width="6%">Address</th>
						<th width="7%">Suburb</th>
						<th width="5%">Type</th>
						<!-- th width="7%">Language</th -->
						<th width="7%">People</th>
						<th width="12%">Special Instructions</th>
						<th width="4%">Attached</th>
							<th width="7%">Date Added</th>
							<th width="8%">Updated</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td width="5%">{{selectedBookingModel.id | PrettyID}}</td>

						<td><span>{{selectedBookingModel.venue.start_time_iso | date:'shortTime'}} - {{selectedBookingModel.venue.end_time_iso | date:'shortTime'}}<br>
													{{selectedBookingModel.venue.start_time_iso | date:'EEE d MMM yy'}}
													</span></td>
						<td>Auslan</td>
						<td>{{selectedBookingModel.client.organisation_primary_contact.first_name + ' ' + selectedBookingModel.client.organisation_primary_contact.last_name}}</td>
						<td>{{selectedBookingModel.venue.title}}</td>
						<td>
							<a target="_blank"
							   href="{{'https://www.google.com.au/maps/place/' + selectedBookingModel.venue.street_number + ' ' + selectedBookingModel.venue.street_name + ' ' + selectedBookingModel.venue.suburb}}">{{selectedBookingModel.venue.street_number + ' ' + selectedBookingModel.venue.street_name}}</a></td>
						<td data-title="SUBURB">
							<a target="_blank"
							   href="{{'https://www.google.com.au/maps/place/' +selectedBookingModel.venue.suburb}}">{{selectedBookingModel.venue.suburb}}</a>
						</td>						<td>{{selectedBookingModel.nature_of_appointment}}</td>
						<td>{{selectedBookingModel.venue.expected_attendance}}</td>
						<td>{{selectedBookingModel.special_instructions}}</td>
						<td align="center" data-title="Attached">
							<ul *ngIf="selectedBookingModel.documents_attributes.length > 0" class="dropdown menu custom" data-dropdown-menu>
								<li>
									<a href="#" class="icon-attach"></a>
									<ul class="menu">
										<li  *ngFor="let attachment of selectedBookingModel.documents_attributes"><a download href="{{attachment.url}}"><i class="icon-attach"></i> {{attachment.file_name}}</a></li>
									</ul>
								</li>
							</ul>
						</td>
						<td>61 days (27 Jan)</td>
						<td><span class="underline">02-06 TS<br>7:15 A</span></td>
					</tr>
				</tbody>
			</table>

			<!-- div class="manage-interpreters-wrapper">
					<section class="manage-interpreters">
						<section>
							<div>
								<b>Interpreter 1:</b> <span>Tim Johnson</span>
								<button>Unassign</button>
							</div>
							<div>
								<b>Interpreter 2:</b> <span>Josef Gray</span>
								<button>Unassign</button>
							</div>
						</section>
					</section>
				</div>

				<div class="manage-interpreters-wrapper">
					<section class="manage-interpreters">
						<section>
							<div>
								<b>Interpreter 1:</b> <span>To be filled</span>&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;<b>Interpreter 2:</b> <span>To be filled</span>
							</div>
						</section>
					</section>
				</div>

				<div align="center">
					<button class="button inverse higher">PROCESS TO INVOICE</button>
				</div -->
			<ng-container *ngIf="anyInterpreterAccepted()">
				<div class="manage-interpreters-wrapper">
					<section class="manage-interpreters">
						<section>
							<ng-container *ngFor="let interpreter of selectedBookingModel.interpreters; let i=index">
								<div *ngIf="i < selectedBookingModel.interpreters_required">
									<b>Interpreter {{i + 1}} :</b>
									<span *ngIf="interpreter.state === 'Accepted'" class='interpreter-accepted'>{{interpreter.first_name}} {{interpreter.last_name}}</span>
									<span *ngIf="interpreter.state !== 'Accepted'">To be filled</span>
									<button name="{{'unassingBtn_' + +(i + 1)}}" (click)="unAssignInterpreters(interpreter.id)" *ngIf="!isCurrentUserInterpreter() && interpreter.state === 'Accepted'">
										Unassign
									</button>

								</div>

							</ng-container>
							<ng-container *ngIf="(selectedBookingModel.interpreters_required - selectedBookingModel.interpreters.length) > 0">
								<ng-container *ngFor="let numb of counter(selectedBookingModel.interpreters_required - selectedBookingModel.interpreters.length ); let ii=index">
									<ng-container *ngIf="ii < (selectedBookingModel.interpreters_required - selectedBookingModel.interpreters.length)">
										<div>
											<b>Interpreter {{selectedBookingModel.interpreters.length + ii + 1}} : </b>
											<span>To be filled</span>
										</div>
									</ng-container>
								</ng-container>
							</ng-container>
						</section>
					</section>
				</div>
			</ng-container>
			<ng-container  *ngIf="!anyInterpreterAccepted()">
				<div class="manage-interpreters-wrapper">
					<section class="manage-interpreters">
						<section>
							<div *ngFor="let numb of counter(selectedBookingModel.interpreters_required); let i=index">
									<b>Interpreter {{i + 1}} :</b>
									<span>To be filled</span>

							</div>
						</section>
					</section>
				</div>
			</ng-container>


			<h2  *ngIf='!isCancelledOrUnableToServe' >Invite Interpreters <button class="outside"></button></h2>
			<section *ngIf='!isCancelledOrUnableToServe' id="invite-interpreters">
				<section id="filters">
					<section class="search-bar" style="width:150%">
						<!--<input type="text" name="search" placeholder="Search...">-->
						<!--<button><i class="icon-glass"></i></button>-->
					</section>

					<section class="filters">
						<!--<button class="button">Select Top 10</button>-->
						<!--<button class="button">Select All Available</button>-->
						<!--<button class="button">Filter Only Available</button>-->

						<div class="separator"></div>

						<button class="button active" name='inviteBtn' (click)="inviteInterpreters()"><i class="icon-shape"></i> Invite</button>
						<button class="button red" (click)="reAssignInterpreters()"  name="reassingBtn"><i class="icon-assign"></i> Assign</button>
					</section>
				</section>
			</section>

			<section *ngIf='!isCancelledOrUnableToServe'  id="invited-interpreters">
				<table class="custom custom-small-table">
					<thead>
						<tr>
							<th width="10%">
								<!--md-checkbox></md-checkbox -->
							</th>
							<th width="7%">
								<span class="">#</span>
							</th>
							<th width="12%">
								<span class="">Status</span>
								<!--<ul class="dropdown menu custom" data-dropdown-menu>-->
									<!--<li>-->
										<!--<a href="#">All</a>-->
										<!--<ul class="menu smaller">-->
											<!--<li><a href="#"><i></i> Option 1</a></li>-->
											<!--<li><a href="#"><i></i> Option 2</a></li>-->
											<!--<li><a href="#"><i></i> Option 3</a></li>-->
										<!--</ul>-->
									<!--</li>-->
								<!--</ul>-->
							</th>
							<th width="17%">
								<span class="">First Name</span>
								<!--<input type="text" name="">-->
							</th>
							<th width="17%">
								<span class="">Last Name</span>
								<!--<input type="text" name="">-->
							</th>
							<th width="9%">
								<span class="">Role</span>
								<!--<ul class="dropdown menu custom" data-dropdown-menu>-->
									<!--<li>-->
										<!--<a href="#">All</a>-->
										<!--<ul class="menu smaller">-->
											<!--<li><a href="#"><i></i> Option 1</a></li>-->
											<!--<li><a href="#"><i></i> Option 2</a></li>-->
											<!--<li><a href="#"><i></i> Option 3</a></li>-->
										<!--</ul>-->
									<!--</li>-->
								<!--</ul>-->
							</th>
							<th width="9%">
								<span class="">Lvl</span>
								<!--<ul class="dropdown menu custom" data-dropdown-menu>-->
									<!--<li>-->
										<!--<a href="#">All</a>-->
										<!--<ul class="menu smaller">-->
											<!--<li><a href="#"><i></i> Option 1</a></li>-->
											<!--<li><a href="#"><i></i> Option 2</a></li>-->
											<!--<li><a href="#"><i></i> Option 3</a></li>-->
										<!--</ul>-->
									<!--</li>-->
								<!--</ul>-->
							</th>
							<th width="15%">
								<span class="">Suburb</span>
								<!--<input type="text" name="">-->
							</th>
							<th width="9%">
								<span class="">KM</span>
							</th>
						</tr>
					</thead>
					<tbody>
						<tr *ngFor="let user of interpreterList; let ind = index">
							<td width="10%">
								<md-checkbox name='{{"Check" + ind}}' [checked]="checkList[ind]===true" (change)="onChange($event,user, ind)"></md-checkbox>
							</td>
							<td>{{user.id}}</td>
							<td align="center"><!-- i [ngClass]="{'icon-check-green' :
							isInvited(user.id), 'icon-check-yellow' : !isInvited(user.id)}"><i --></td>
							<td><!-- i [ngClass]="{'icon-check-yellow' : isNotConfirmed(user.id)}"></i --> {{user.first_name}}</td>
							<td>{{user.last_name}}</td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
						</tr>
					</tbody>
				</table>
				<section>
					<section id="time">11 September 9:15 AM - 11:15 AM</section>
					<section>
						<section id="time-range">
							<button type="button">&lt;</button>
							<section>
								<span>6 am</span>
								<span>7 am</span>
								<span>8 am</span>
								<span>9 am</span>
								<span>11 am</span>
								<span>12 am</span>
								<span>1 pm</span>
							</section>
							<button type="button">&gt;</button>
						</section>
						<section class="flow">
							<div><span></span></div>
							<div><span style="margin-left: 2%"></span></div>
							<div><span style="margin-left: 15%"></span></div>
							<div><span style="margin-left: 3%"></span></div>
							<div><span style="margin-left: 22%"></span></div>
						</section>
						<div id="mover"></div>
					</section>
				</section>
			</section>

			<h2>History</h2>
			<table id="changes-history" class="custom-small-table">
				<thead>
					<th width="20%">Date and Time</th>
					<th width="30%">Action</th>
					<th>Changes</th>
				</thead>
				<tbody>
					<tr *ngFor="let version of selectedBookingModel.versions; let i=index">
						<td name="data_created_at">{{version.created_at_iso | date:'shortTime'}} on {{version.created_at_iso | date:'EEE d MMM yy'}}</td>
						<td><img height="40px" width="40px" src="{{version.photo_url}}" alt="">
							<span name="data_action">{{version.booking_event_formatted()}}<br/>{{version.full_name()}}
							</span>
						</td>
						<td>
							<div name="data_changes">
							<div *ngFor="let change_item_key of version.change_set_formatted_hash()">
									<b>{{change_item_key[0]}}: </b>{{change_item_key[1][0]}} <b>to</b> <span>{{change_item_key[1][1]}}</span>
							</div>
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</main>
	</section>
</section>
