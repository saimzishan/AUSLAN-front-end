<section id="submenu">
    <app-user-header id="main-submenu-links">
    </app-user-header>
</section>
<header class="text-center hidden-mobile">
    <h1>{{ param_id < 1 ? 'ADD BLOCKOUT' : 'EDIT BLOCKOUT'}}</h1>
</header>
<header id="header-mobile">
    <button [routerLink]="['/user-management/profile']" class="icon-back"></button>

    <h1>{{ param_id < 1 ? 'ADD BLOCKOUT' : 'EDIT BLOCKOUT'}}</h1>

    <section>
        <a href="#" class="header__message"><i class="icon-messages"></i></a>
        <ul class="dropdown menu" data-disable-hover="true" data-click-open="true" data-dropdown-menu>
            <li>
                <a href="#" class="header__profile"><img src="assets/img/dummy/profile.png"></a>
                <ul class="menu">
                    <li><a href="#"><i class="icon-logout"></i> Log Out</a></li>
                </ul>
            </li>
        </ul>
    </section>
</header>
<section id="page-add-blockout">
    <main>
        <form #user_blockout_form="ngForm" class="common-form compact with-mobile-transformation">
            <div class="row small-collapse">
                <div class="row-wrapper">
                    <div class="small-12 columns">
                        <div class="form-field">
                            <label>NAME BLOCKOUT *</label>

                            <input type='text'
                                   name='blockout_name'
                                   [(ngModel)]="availabilityBlock.name" [rangeLength]="[1,50]" required
                                   #blockout_name="ngModel"/>

                            <span *ngIf="blockout_name.touched &&  (!blockout_name.errors?.required && blockout_name.errors?.rangeLength);"
                                  class="inline-icon inline-icon-valid valid"></span>
                            <span *ngIf="blockout_name.touched && (blockout_name.errors?.required || blockout_name.errors?.rangeLength);"
                                  class="inline-icon error">
									<span>Minimum 1 characters required.</span>!</span>
                        </div>
                    </div>
                    <div class="small-12 columns">
                        <div class="form-field">
                            <label>START DATE TIME *</label>

                            <p-calendar name='dpEventDate_st' (onClose)="onStartTimeChanged()" [(ngModel)]="start_time"
                                        required #dpEventDate_st="ngModel" showTime="true" hourFormat="12"></p-calendar>


                            <span *ngIf="dpEventDate_st.touched &&  (!dpEventDate_st.errors?.required);"
                                  class="inline-icon inline-icon-valid valid"></span>
                            <span *ngIf="dpEventDate_st.touched && (dpEventDate_st.errors?.required);"
                                  class="inline-icon error">
									<span>Start Date is required.</span>!</span>
                        </div>
                    </div>
                    <div class="small-12 columns">
                        <div class="form-field">
                            <label>END TIME *</label>

                            <p-calendar name='dpEventDate_endtime' [(ngModel)]="end_time"
                                        required #dpEventDate_endtime="ngModel" [timeOnly]="true"
                                        hourFormat="12"></p-calendar>

                            <span *ngIf="dpEventDate_endtime.touched &&  (!dpEventDate_endtime.errors?.required);"
                                  class="inline-icon inline-icon-valid valid"></span>
                            <span *ngIf="dpEventDate_endtime.touched && (dpEventDate_endtime.errors?.required);"
                                  class="inline-icon error">
									<span>End Time is required.</span>!</span>
                            <span *ngIf="start_time.getTime() === end_time.getTime()"
                                  class="inline-icon error">
									<span>End Time should be greater than start time</span>!</span>
                        </div>
                    </div>
                    <div class="small-12 columns">
                        <div class="form-field">
                            <label>RECURRING *</label>

                            <md-slide-toggle

                                    name='sldRecurring'
                                    [(ngModel)]="availabilityBlock.recurring" required #sldRecurring="ngModel">
                            </md-slide-toggle>
                        </div>
                    </div>

                    <div *ngIf="availabilityBlock.recurring">

                        <div class="small-12 columns">
                            <div class="form-field">
                                <label>FREQUENCY *</label>

                                <select [(ngModel)]="availabilityBlock.frequency" name="availabilityBlock_frequency"
                                        #availabilityBlock_frequency="ngModel" required
                                        aria-label="A">
                                    <option *ngFor="let frequency_name of ['daily', 'weekly']"
                                            [value]="frequency_name">{{frequency_name.toUpperCase()}}
                                    </option>

                                </select>

                            </div>
                        </div>
                        <div class="small-12 columns">

                            <div class="form-field">
                                <label>END DATE *</label>

                                <p-calendar name='dpEventDate_end' [(ngModel)]="end_date"
                                            required #dpEventDate_end="ngModel"></p-calendar>

                                <span *ngIf="dpEventDate_end.touched &&  (!dpEventDate_end.errors?.required);"
                                      class="inline-icon inline-icon-valid valid"></span>
                                <span *ngIf="dpEventDate_end.touched && (dpEventDate_end.errors?.required);"
                                      class="inline-icon error">
									<span>End Date is required.</span>!</span>
                                <span *ngIf="start_time.getDate() > end_date.getDate()"
                                      class="inline-icon error">
									<span>End date should be equal or greater than start time</span>!</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </form>
        <div >
            <div class="manage-buttons">
                <button name="cancel_blockout" [routerLink]="['/user-management/profile']"  class="button decline">CANEL</button>
                <button *ngIf="availabilityBlock.id > 0" name="delete_blockout" (click)="deleteBlockout()" class="button decline">DELETE</button>
                <button name="save_blockout" (click)="saveBlockouts(user_blockout_form)"  class="button">SAVE</button>
            </div>
        </div>
    </main>
</section>

<nav id="footer-mobile">
    <a href="#"><i class="icon-home"></i><span>HOME</span></a>
    <a href="#"><i class="icon-jobs"></i><span>JOBS</span></a>
    <a href="#" class="active"><i class="icon-profile"></i><span>PROFILE</span></a>
</nav>
